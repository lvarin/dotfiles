#!/usr/bin/env bash
set -e

DOTFILESPATH="$( cd "$(dirname "$0")/.." ; pwd -P )"

hosts="$1"
tags="$2"

if [ -z $tags ]; then
  tags="all"
fi

if [ -z $hosts ];
then
  hosts='~/.dotfiles/hosts'
fi

if ! [ -x "$(command -v ansible)" ]; then
  sudo apt install ansible -y
fi

if [ ! -d ~/.dotfiles ];
then
	ln -s $DOTFILESPATH ~/.dotfiles
fi

ansible-playbook -i $hosts ~/.dotfiles/dotfiles.yml --ask-become-pass --tags $tags

if command -v terminal-notifier 1>/dev/null 2>&1; then
  terminal-notifier -title "dotfiles: Bootstrap complete" -message "Successfully set up dev environment."
fi
